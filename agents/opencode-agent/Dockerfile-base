# OpenCode Agent Dockerfile
#
# Inherits from central portle-agent-base which provides:
# - Python 3.12, Node.js 22.x, simulation tools (iverilog, verilator)
#
# This agent adds OpenCode CLI and agent-specific Python dependencies.

ARG BASE_IMAGE=portle-agent-base:latest
FROM ${BASE_IMAGE}

WORKDIR /app

# Install OpenCode CLI
RUN npm install -g opencode-ai

# Python deps (exact versions from requirements)
COPY requirements.txt ./requirements.txt
RUN python3.12 -m pip install --upgrade-strategy only-if-needed -r requirements.txt && \
    python3.12 -m pip check
